<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Spring Cloud Config | tiangao | 天高云淡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="SpringCloud">
    <meta name="description" content="背景现今这个时候，微服务大行其道，互联网应用遍地都是，随便开发个什么应用首要考虑的都是要可伸缩，扩展性要好。当我们的后台服务一点点增多，各个服务的配置也越来越多，随之而来的就是一个配置管理问题，各自管各自的开发时没什么问题，到了线上之后管理就会很头疼，到了要大规模更新的时候就更烦了。我们的后台服务就是如此，各种语言开发的都有，在慢慢的迭代过程的我们发现配置中心是一个比较好的解决方案，作为 Spri">
<meta name="keywords" content="SpringCloud">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Cloud Config">
<meta property="og:url" content="http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/index.html">
<meta property="og:site_name" content="tiangao">
<meta property="og:description" content="背景现今这个时候，微服务大行其道，互联网应用遍地都是，随便开发个什么应用首要考虑的都是要可伸缩，扩展性要好。当我们的后台服务一点点增多，各个服务的配置也越来越多，随之而来的就是一个配置管理问题，各自管各自的开发时没什么问题，到了线上之后管理就会很头疼，到了要大规模更新的时候就更烦了。我们的后台服务就是如此，各种语言开发的都有，在慢慢的迭代过程的我们发现配置中心是一个比较好的解决方案，作为 Spri">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/b6e1ba88-36a7-4fa6-ba93-2b0e501e6c1b.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/c2b3c8e9-4054-4eaa-9071-1300a731340e.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/3905cf7f-9fde-4460-b7d6-1f8724a7dda9.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/9393a355-cd47-432a-85bf-05e6e8766b7c.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/fb006d98-a00b-40d6-930a-64e14a3ea9dc.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/8af714a1-4df6-4d5c-90ec-54da2512fb0a.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/5b34de0d-05df-441a-9533-00ad502718f3.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/4c86bfd4-8662-47a4-95b0-6201d2caf38e.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/628bcb17-0bde-4864-99ad-f9a69e189302.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/b7d1349b-4605-43c4-879b-d4a87c2432d6.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/82d8c322-3bbd-4654-9112-75142b6ebef4.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/7fa57f51-cb10-4f2b-9f54-abe35a287d0b.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/42731a32-f6ae-4171-80dd-cac05b4441bc.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/38573fcc-7fd0-4c7e-b453-b7ce62212f3f.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/030ff2b9-dc9e-4b53-b428-da74e5d63c6c.png">
<meta property="og:image" content="https://dn-coding-net-production-pp.qbox.me/9e2bc064-cf1a-4204-aa7b-6af434916f40.png">
<meta property="og:updated_time" content="2021-10-06T10:51:31.092Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring Cloud Config">
<meta name="twitter:description" content="背景现今这个时候，微服务大行其道，互联网应用遍地都是，随便开发个什么应用首要考虑的都是要可伸缩，扩展性要好。当我们的后台服务一点点增多，各个服务的配置也越来越多，随之而来的就是一个配置管理问题，各自管各自的开发时没什么问题，到了线上之后管理就会很头疼，到了要大规模更新的时候就更烦了。我们的后台服务就是如此，各种语言开发的都有，在慢慢的迭代过程的我们发现配置中心是一个比较好的解决方案，作为 Spri">
<meta name="twitter:image" content="https://dn-coding-net-production-pp.qbox.me/b6e1ba88-36a7-4fa6-ba93-2b0e501e6c1b.png">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">stiangao</h5>
          <a href="mailto:tiangao1102@163.com" title="tiangao1102@163.com" class="mail">tiangao1102@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/j2go" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Spring Cloud Config</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="搜索">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Spring Cloud Config</h1>
        <h5 class="subtitle">
            
                <time datetime="2016-11-30T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2016-12-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#背景"><span class="post-toc-number">1.</span> <span class="post-toc-text">背景</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解决方案"><span class="post-toc-number">2.</span> <span class="post-toc-text">解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Spring-Cloud-Config-项目"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">Spring Cloud Config 项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Spring-Cloud-Config-Server"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Spring Cloud Config Server</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Spring-Cloud-Config-Client"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">Spring Cloud Config Client</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#简单使用示例"><span class="post-toc-number">3.</span> <span class="post-toc-text">简单使用示例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#新建仓库"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">新建仓库</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#新建一个标准-maven-项目"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">新建一个标准 maven 项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#启动效果"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">启动效果</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安全配置"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">安全配置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#客户端配置"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">客户端配置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#流程示意图"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">流程示意图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置加载源"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">配置加载源</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#疑问"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">疑问</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#原理探究"><span class="post-toc-number">4.</span> <span class="post-toc-text">原理探究</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#访问方式"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">访问方式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#资源抽象实现"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">资源抽象实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#客户端加载原理"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">客户端加载原理</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#小结"><span class="post-toc-number">5.</span> <span class="post-toc-text">小结</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-2016-12-01-cloud-config"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Spring Cloud Config</h1>
        <div class="post-meta">
            <time class="post-time" title="2016-12-01 00:00:00" datetime="2016-11-30T16:00:00.000Z"  itemprop="datePublished">2016-12-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>现今这个时候，微服务大行其道，互联网应用遍地都是，随便开发个什么应用首要考虑的都是要可伸缩，扩展性要好。<br>当我们的后台服务一点点增多，各个服务的配置也越来越多，随之而来的就是一个配置管理问题，各自管各自的开发时没什么问题，到了线上之后管理就会很头疼，到了要大规模更新的时候就更烦了。<br>我们的后台服务就是如此，各种语言开发的都有，在慢慢的迭代过程的我们发现配置中心是一个比较好的解决方案，作为 Spring 的拥趸我们自然就看中了 Spring Cloud Config。<br>一般服务器的应用都有以下几种类型:<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/b6e1ba88-36a7-4fa6-ba93-2b0e501e6c1b.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure><br>其中当属业务部分最多也最繁杂。<br>当应用变得越来越庞大和复杂时，单机就肯定不能满足需求了，然后就要考虑分布式了，接下去还可能会应用不同的语言来开发应用。   </p>
<p> <img src="https://dn-coding-net-production-pp.qbox.me/c2b3c8e9-4054-4eaa-9071-1300a731340e.png" alt="图片"><br>比如 nginx 毫无疑问的是用的最多的反向代理组件，使用 OpenResty 便要用到 lua，再比如前端要 seo ，一个解决办法就是使用 nodejs，到了后端分布式，那就更繁多了，可能会需要把业务一个个拆分成不同的服务单独运行…<br>然后就发现散落一地的配置文件，<strong>properties</strong>、<strong>yml</strong>、<strong>json</strong> …</p>
<p>为了解决这个问题，我们采取了这么一种方案，通过 etcd 来收集所有的配置，然后统一的写到一个文件中去，任何应用都来访问这一个文件来找到自己的配置并应用。<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/3905cf7f-9fde-4460-b7d6-1f8724a7dda9.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<p>这很好的解决了配置散落的问题，可以集中管理了，但是又一个问题来了，各种类型的配置在一个文件里看起来好乱，而且在初始化时必须要完成这个文件才能启动应用。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>所以下一个解决方案便想到用一个配置中心来搞定。<br>  <img src="https://dn-coding-net-production-pp.qbox.me/9393a355-cd47-432a-85bf-05e6e8766b7c.png" alt="图片"> </p>
<h3 id="Spring-Cloud-Config-项目"><a href="#Spring-Cloud-Config-项目" class="headerlink" title="Spring Cloud Config 项目"></a>Spring Cloud Config 项目</h3><ul>
<li>提供 <strong>服务端</strong> 和 <strong>客户端</strong> 支持</li>
<li><strong>集中式</strong> 管理分布式环境下的应用配置</li>
<li>基于 <strong>Spring</strong> 环境，无缝 与 Spring 应用集成</li>
<li>可用于 <strong>任何</strong> 语言开发的程序</li>
<li>默认实现基于 <strong>git</strong> 仓库，可以进行 <strong>版本管理</strong></li>
<li><strong>可替换</strong> 自定义实现</li>
</ul>
<h3 id="Spring-Cloud-Config-Server"><a href="#Spring-Cloud-Config-Server" class="headerlink" title="Spring Cloud Config Server"></a>Spring Cloud Config Server</h3><p>作为配置中心服务端</p>
<ul>
<li>拉取配置时更新 git 仓库副本，保证是最新结果</li>
<li>支持数据结构丰富，yml, json, properties 等</li>
<li>配合 eureke 可实现服务发现，配合 cloud bus 可实现配置推送更新</li>
<li>配置存储基于 git 仓库，可进行版本管理</li>
<li>简单可靠，有丰富的配套方案</li>
</ul>
<h3 id="Spring-Cloud-Config-Client"><a href="#Spring-Cloud-Config-Client" class="headerlink" title="Spring Cloud Config Client"></a>Spring Cloud Config Client</h3><p>默认客户端实现</p>
<ul>
<li>SpringBoot 项目不需要改动任何代码，加入一个启动配置文件指明使用 ConfigServer 上哪个配置文件即可</li>
</ul>
<h2 id="简单使用示例"><a href="#简单使用示例" class="headerlink" title="简单使用示例"></a>简单使用示例</h2><h3 id="新建仓库"><a href="#新建仓库" class="headerlink" title="新建仓库"></a>新建仓库</h3><p>新建一个 git 仓库，添加一个配置文件。<br>例如想要一个 billing的服务，性质是开发，运行环境是测试环境。<br>那么就新建一个 testing 的分支，然后提交一个 billing-dev.properties 的文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">devMode = true</span><br><span class="line">spring.application.name = billing</span><br><span class="line">spring.jdbc.host = localhost</span><br><span class="line">spring.jdbc.port = 3306</span><br><span class="line">spring.jdbc.user = root</span><br><span class="line">spring.jdbc.password = 123qwe</span><br><span class="line">loging.file = demo</span><br></pre></td></tr></table></figure></p>
<h3 id="新建一个标准-maven-项目"><a href="#新建一个标准-maven-项目" class="headerlink" title="新建一个标准 maven 项目"></a>新建一个标准 maven 项目</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/fb006d98-a00b-40d6-930a-64e14a3ea9dc.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> 
<p><strong>ConfigServer.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigServer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConfigServer<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>application.yml</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8888</span><br><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    config:</span><br><span class="line">      server:</span><br><span class="line">        git:</span><br><span class="line">          uri:https://git.coding.net/tiangao/demo-config-server.git</span><br><span class="line">          clone-on-start: true</span><br></pre></td></tr></table></figure></p>
<p><strong>pom.xml</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">    &lt;artifactId&gt;config-server&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.1.0&lt;/version&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.4.1.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-config-server --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.2.1.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="启动效果"><a href="#启动效果" class="headerlink" title="启动效果"></a>启动效果</h3><p> 配置中心已经可以启动,最简单的访问方式可以访问浏览器。<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/8af714a1-4df6-4d5c-90ec-54da2512fb0a.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure><br>想要 json 格式的怎么办呢<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/5b34de0d-05df-441a-9533-00ad502718f3.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure><br>还有 yml, properties<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/4c86bfd4-8662-47a4-95b0-6201d2caf38e.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure><br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/628bcb17-0bde-4864-99ad-f9a69e189302.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<h3 id="安全配置"><a href="#安全配置" class="headerlink" title="安全配置"></a>安全配置</h3><p> 添加 Security 依赖，配置用户名和密码访问，毕竟直接通过 url 就可以访问太不安全了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后在 application.yml 中配置用户名密码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">security:</span><br><span class="line">  user:</span><br><span class="line">    password: db1ab002-1fba-476d-a421-22113355</span><br></pre></td></tr></table></figure></p>
<p>再访问就能看到如下的效果<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/b7d1349b-4605-43c4-879b-d4a87c2432d6.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure><br><strong>以上就是 ConfigSever 默认实现的基本的 HttpBasic 的认证</strong></p>
<h3 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h3><p>SpringBoot 客户端配置，仅仅只需要添加一个启动配置文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    config:</span><br><span class="line">      uri: http://127.0.0.1:8888</span><br><span class="line">      profile: dev</span><br><span class="line">      label: testing</span><br><span class="line">      name: billing</span><br><span class="line">      password: db1ab002-1fba-476d-a421-22113355</span><br><span class="line">      username: user</span><br></pre></td></tr></table></figure></p>
<p>当启动时看到下面标示的内容是即表示加载成功<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/82d8c322-3bbd-4654-9112-75142b6ebef4.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<h3 id="流程示意图"><a href="#流程示意图" class="headerlink" title="流程示意图"></a>流程示意图</h3> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/7fa57f51-cb10-4f2b-9f54-abe35a287d0b.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> 
<h3 id="配置加载源"><a href="#配置加载源" class="headerlink" title="配置加载源"></a>配置加载源</h3><p>所有的配置都通过仓库来管理，应用启动时访问配置中心能拿到自己的配置即可加载，接下来再进入各自的初始化过程。<br>仓库也不仅仅只能用 git, 还有 svn 和本地目录可以选择</p>
<ul>
<li><strong>svn://${user.home}/config-repo</strong></li>
<li><strong>file://${user.home}/config-repo</strong></li>
</ul>
<h3 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h3><p>从上面的简单使用里可以看出，我们只要提交一种格式的配置文件，通过不同的方式访问即可得到不同格式的配置文件，真棒。那么这在ConfigServer里是如何实现的呢？</p>
<h2 id="原理探究"><a href="#原理探究" class="headerlink" title="原理探究"></a>原理探究</h2><h3 id="访问方式"><a href="#访问方式" class="headerlink" title="访问方式"></a>访问方式</h3><p><strong>首先看一共有多少种访问方式</strong></p>
<ul>
<li>/{name}/{profiles:.<em>[^-].</em>}</li>
<li>/{name}/{profiles}/{label:.*}</li>
<li>/{name}-{profiles}.properties</li>
<li>/{label}/{name}</li>
<li>/{profiles}.properties</li>
<li>/{name}-{profiles}.json</li>
<li>/{label}/{name}-{profiles}.json</li>
</ul>
<p><strong>name</strong> 可以代表应用名，<strong>profiles</strong> 是属性，可以用来甄别是什么用途，<strong>label</strong> 就是 git 的标签了，大约可以用来指明环境。<br>接下来再看就转到这么一个包含各种资源类型的转换操作的集合类上面，同时暴露资源接口。其中方法如下图所示：</p>
<p> <img src="https://dn-coding-net-production-pp.qbox.me/42731a32-f6ae-4171-80dd-cac05b4441bc.png" alt="图片"> </p>
<p>原来内部只存在一种资源抽象：<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/38573fcc-7fd0-4c7e-b453-b7ce62212f3f.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<h3 id="资源抽象实现"><a href="#资源抽象实现" class="headerlink" title="资源抽象实现"></a>资源抽象实现</h3><p>一个应用的配置只需要应用名、属性和标签就可以定位到。嗯，原来这么简单，那 EnvironmentReposiroty 又是哪里实现呢？</p>
<p>扒扒类图：<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/030ff2b9-dc9e-4b53-b428-da74e5d63c6c.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<p><strong>findOne()</strong> 方法在 AbstractScmEnvironmentRepository 中可以找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public synchronized Environment findOne(String application, String profile, String label) &#123;</span><br><span class="line">	NativeEnvironmentRepository delegate = new NativeEnvironmentRepository(getEnvironment());</span><br><span class="line">	Locations locations = getLocations(application, profile, label);</span><br><span class="line">	delegate.setSearchLocations(locations.getLocations());</span><br><span class="line">	Environment result = delegate.findOne(application, profile, &quot;&quot;);</span><br><span class="line">	result.setVersion(locations.getVersion());</span><br><span class="line">	result.setLabel(label);</span><br><span class="line">	return this.cleaner.clean(result, getWorkingDirectory().toURI().toString(), getUri());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这其中又由 SearcPathLocator 接口的 getLocations() 来实际加载内容,这个方法就由具体的实现类来完成。<br>Spring Cloud Config Server 内部除了 JGitEnvironmentRepository 实现外还有另外三种实现。</p>
<ul>
<li>SvnKitEnvironmentRepository</li>
<li>NativeEnvironmentRepository</li>
<li>MultipleJGitEnvironmentRepository</li>
</ul>
<p>见名知其意，分别是 svn 本地目录以及多 git 仓库的实现，具体内容就不细说，大家有兴趣可自行研究。</p>
<h3 id="客户端加载原理"><a href="#客户端加载原理" class="headerlink" title="客户端加载原理"></a>客户端加载原理</h3><p>项目只需要加载依赖就可以使用远程配置，现有项目迁移过去也不用改动任何代码，刚使用的时候感觉真是爽快。<br>达到这样的效果背后依赖于 SpringMVC 自身的优秀的抽象实现以及 Springboot 的实用的自动配置类加载。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class ConfigClientAutoConfiguration &#123;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public ConfigClientProperties configClientProperties(</span><br><span class="line">			Environment environment,</span><br><span class="line">			ApplicationContext context) &#123;...&#125;</span><br><span class="line">	...</span><br><span class="line">	@Bean</span><br><span class="line">	public ConfigServerHealthIndicator configServerHealthIndicator(</span><br><span class="line">			ConfigServicePropertySourceLocator locator,</span><br><span class="line">			ConfigClientHealthProperties properties, Environment environment) &#123;</span><br><span class="line">		return new ConfigServerHealthIndicator(locator, environment, properties);</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>无关的逻辑部分在这里就省去了，接着看。<br><strong>ConfigClientAutoConfiguration</strong> 这个是 ConfigClient 的自动配置类,加载时触发新建一个 <strong>ConfigServicePropertySourceLocator</strong> 的 bean。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Order(0)</span><br><span class="line">public class ConfigServicePropertySourceLocator </span><br><span class="line">		implements PropertySourceLocator &#123;</span><br><span class="line">			</span><br><span class="line">	private RestTemplate restTemplate;</span><br><span class="line">	private ConfigClientProperties defaultProperties;</span><br><span class="line">	...</span><br><span class="line">	@Override</span><br><span class="line">	@Retryable(interceptor = &quot;configServerRetryInterceptor&quot;)</span><br><span class="line">	public org.springframework.core.env.PropertySource&lt;?&gt; locate(</span><br><span class="line">			org.springframework.core.env.Environment environment) &#123;</span><br><span class="line">		...</span><br><span class="line">			// Try all the labels until one works</span><br><span class="line">			for (String label : labels) &#123;</span><br><span class="line">				Environment result = getRemoteEnvironment(restTemplate,</span><br><span class="line">						properties, label.trim(), state);</span><br><span class="line">						...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后在 ApplicationContextInitializer 的 initialize() 方法中被调用 locate() 方法从 ConfigServer 拉取配置文件，注入到 <strong>ConfigurableEnvironment</strong> 里。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableConfigurationProperties(PropertySourceBootstrapProperties.class)</span><br><span class="line">public class PropertySourceBootstrapConfiguration implements</span><br><span class="line">		ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt;, Ordered &#123;</span><br><span class="line">	...</span><br><span class="line">	@Override</span><br><span class="line">	public void initialize(ConfigurableApplicationContext applicationContext) &#123;</span><br><span class="line">		...</span><br><span class="line">		ConfigurableEnvironment environment = applicationContext.getEnvironment();</span><br><span class="line">		for (PropertySourceLocator locator : this.propertySourceLocators) &#123;</span><br><span class="line">			PropertySource&lt;?&gt; source = null;</span><br><span class="line">			source = locator.locate(environment);</span><br><span class="line">			if (source == null) &#123;</span><br><span class="line">				continue;</span><br><span class="line">			&#125;</span><br><span class="line">			...</span><br><span class="line">		&#125;</span><br><span class="line">		...</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来才进入应用的初始化过程。<br>从以上过程可以看到，其他任何应用需要使用 ConfigServer 时也只需要在应用初始化之前通过  HTTP 请求拉取到配置文件即可。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>了解了大致原理，便可以捋一捋集中式管理的优点。<br> <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://dn-coding-net-production-pp.qbox.me/9e2bc064-cf1a-4204-aa7b-6af434916f40.png" alt="图片" title>
                </div>
                <div class="image-caption">图片</div>
            </figure> </p>
<ul>
<li><p>没有记忆负担：大家都使用一个仓库保存所有配置文件，方便查看。</p>
</li>
<li><p>降低冲突沟通成本：开发新功能是凡是有配置变动均向仓库的提交，在合并后其他人碰到配置问题时也不用到处找人问，看看仓库历史就知道什么发生了变化。   </p>
</li>
</ul>
<ul>
<li><p>方便测试：测试环境下，测试人员也不用老是问开发环境配置的问题了，所有配置一目了然，更改记录也都有提交说明，有问题向开发反馈也能帮助快速定位问题范围。   </p>
</li>
<li><p>方便管理： 在模拟环境和生产环境下，由运维人员管理线上配置文件，只要设置好分支保护和权限分配。</p>
</li>
</ul>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2021-10-06T10:51:31.092Z" itemprop="dateUpdated">2021-10-06 18:51:31</time>
</span><br>


        
        转载请注明出处 <a href="/2016/11/30/2016-12-01-cloud-config/" target="_blank" rel="external">http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/</a>
        
    </div>
    <footer>
        <a href="http://j2go.github.io">
            <img src="/img/avatar.jpg" alt="stiangao">
            stiangao
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringCloud/">SpringCloud</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&title=《Spring Cloud Config》 — tiangao&pic=http://j2go.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&title=《Spring Cloud Config》 — tiangao&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Spring Cloud Config》 — tiangao&url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&via=http://j2go.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2016/12/31/2017-01-26-iphone-battery/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">查看 IPhone 电池信息</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2016/11/29/2016-11-30-Java7-file-op/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Java7 文件夹操作</h4>
      </a>
    </div>
  
</nav>



    





<section class="comments" id="comments">
    <!-- UY BEGIN -->
    <div id="uyan_frame"></div>
    <script src="http://v2.uyan.cc/code/uyan.js?uid=2142800"></script>
    <!-- UY END -->
</section>










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>stiangao &copy; 2015 - 2021</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&title=《Spring Cloud Config》 — tiangao&pic=http://j2go.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&title=《Spring Cloud Config》 — tiangao&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Spring Cloud Config》 — tiangao&url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/&via=http://j2go.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://j2go.github.io/2016/11/30/2016-12-01-cloud-config/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3ay27DMAxE0fz/T7vropU9w1GCiLxaBYEfOlrQIsXXSx7Xn6Fcc3/l6vfqrg0DBgwYxzKu27F6gfLP6i219z4sEAwYMAYwkrC4erQbQFdPvp8bDBgwYLiM+7uU6cKAAQPGLobyhFp4hQEDBowkidULcLXt44dycRgwYBzI0IPj53+/5XwDBgwYRzEuc+xKevOZ/HomDBgwWjP0AKdvy/Jr3PnAgAGjN8Mt7rtTURLdWur7EOlhwIDRjpG0Z0WRPlhQe4cLAwaMwxlJzSppy8hTX2kNYMCAcTjDbXFI7tKn6G4oYcCAMYGhB2V3cnrpLdlWwoABozfDLdC7W0N90lHyDAMGjAEMfYpJHd4N00aKCwMGjNYMPSzqBwNu+1eS4tq7WhgwYBzIUJq9aocESjFOX9eHzwAMGDBGMpKjgqSRwg3ry54RGDBgNGXkJba8bUJfPhgwYMxhuI+rhU4dVtuqwoABYwJjgzveMrpHp//cCwMGjGGMZIumJ6J6cDeKbjBgwBjAcI8BlOawGkMJ+jBgwJjGqB0GuC9ODh4eCm0wYMBoyrjMoR8J1DaIxWWFAQNGa4ZbMtsF3rXFtGEwYMA4lvGOEJk0mRUDLgwYMAYwdpXP9FPFPIk1mi1gwIAxkuG2ee06QtgccGHAgNGa4R4D6Dm03max+bsBAwaMr2foiWgydRdgLAcMGDBaM9x2iuT6WjlP+QzAgAGjKeMHLFIi4OmVvwcAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'stiangao's blog';
            clearTimeout(titleTime);
        } else {
            document.title = '天高的博客';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
